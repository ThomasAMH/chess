Where we left off:
Get those join game tests with the same username working

## Other Things
Join games you've left
Join games without calling list

Planning helper
1. Intended function
2. Context (command to use)
3. Arguments
4. Returns
5. Error types
6. Logic of positive use
7. Identify error catching

## Functionality for Client
* Possible moves
  * Command: _moves_
  * Argument: A chess position
  * Returns: A chess board image with all possible moves highlighted in green/dark green
  * Throws: Nothing. If space is empty, red error text is returned saying "Error: No piece at location"
  * Logic:
    * Check if there is a piece at location
    * Fetch the possible moves for that piece (use the function)
    * Draw the chessboard, and if an i,j coord is in the moves list, use alt. colors
    * Print message: Showing moves for [piece type] at [location]
* Leave (-> post login UI)
  * Command: Leave
  * Returns: Nothing
  * Throws: Nothing
  * Logic:
    * Send "left" message via websocket
    * Close websocket connection
    * Change program state
    * Return happy message
* Make move & update board
  * Command: move <r,c> <r,c>
  * Logic
    * Check if move is valid
    * Update the chessboard (use function)
    * Redraw the chessboard for client
    * Send updated board via websocket
* Redraw
  * Command: redraw
  * Logic:
    * Clear the terminal and redraw the board + vital information
* Resign
  * Command: resign
  * Send message to server via websocket
  * Change state to observer (??) or find some way to disable other commands except for leave
  * Return a message
* Show game information (current player's turn)


## Notifications
1. A user connected to the game as a player (black or white). The notification message should include the player’s name and which side they are playing (black or white).
2. A user connected to the game as an observer. The notification message should include the observer’s name.
3. A player made a move. The notification message should include the player’s name and a description of the move that was made. (This is in addition to the board being updated on each player’s screen.)
4. A player left the game. The notification message should include the player’s name.
5. A player resigned the game. The notification message should include the player’s name.
6. A player is in check. The notification message should include the player’s name (this notification is generated by the server). 
7. A player is in checkmate. The notification message should include the player’s name (this notification is generated by the server).

## Websocket

### Client's Role
1. Call the server join HTTP API to join them to the game. This step is only done for players. Observers do not need to make the join HTTP API request.
2. Open a WebSocket connection with the server (using the /ws endpoint) so it can send and receive gameplay messages. 
3. Send a CONNECT WebSocket message to the server. 
4. Transition to the gameplay UI. The gameplay UI draws the chess board and allows the user to perform the gameplay commands described in the previous section.

## Websocket Messages
### Commands to the server

| Command       | Required Additional Fields | Description                                                                          |
| ------------- | -------------------------- | ------------------------------------------------------------------------------------ |
| **CONNECT**   |                            | Used for a user to make a WebSocket connection as a player or observer.              |
| **MAKE_MOVE** | ChessMove move             | Used to request to make a move in a game.                                            |
| **LEAVE**     |                            | Tells the server you are leaving the game so it will stop sending you notifications. |
| **RESIGN**    |                            | Forfeits the match and ends the game (no more moves can be made).                    |

### Commands from the server
| Command          | Required Fields                                        | Description                                                                                                                         |
| ---------------- | ------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------- |
| **LOAD_GAME**    | game (can be any type, just needs to be called `game`) | Used by the server to send the current game state to a client. When a client receives this message, it will redraw the chess board. |
| **ERROR**        | String errorMessage                                    | This message is sent to a client when it sends an invalid command. The message must include the word `Error`.                       |
| **NOTIFICATION** | String message                                         | This is a message meant to inform a player when another player made an action.                                                      |

## Websocket Functionality
A client will instigate all gameplay interactions by sending a CONNECT UserGameCommand to the server. We refer to the instigating client as the Root Client. The server will receive this Command and send appropriate ServerMessages to all clients connected to that game.

When sending a Notification that refers to one of the clients, the message should use the Clients username. (E.g., Bob left the game).

If a UserGameCommand is invalid (e.g. invalid authToken or gameID doesn’t exist) the server should only send an Error message informing the Root Client what went wrong. No messages should be sent to the other Clients. The Error message must contain the word error (case doesn’t matter).

Root Client sends CONNECT

Server sends a LOAD_GAME message back to the root client.
Server sends a Notification message to all other clients in that game informing them the root client connected to the game, either as a player (in which case their color must be specified) or as an observer.
Root Client sends MAKE_MOVE

Server verifies the validity of the move.
Game is updated to represent the move. Game is updated in the database.
Server sends a LOAD_GAME message to all clients in the game (including the root client) with an updated game.
Server sends a Notification message to all other clients in that game informing them what move was made.
If the move results in check, checkmate or stalemate the server sends a Notification message to all clients.
Root Client sends LEAVE

If a player is leaving, then the game is updated to remove the root client. Game is updated in the database.
Server sends a Notification message to all other clients in that game informing them that the root client left. This applies to both players and observers.
Root Client sends RESIGN

Server marks the game as over (no more moves can be made). Game is updated in the database.
Server sends a Notification message to all clients in that game informing them that the root client resigned. This applies to both players and observers.

## Completed Functionality